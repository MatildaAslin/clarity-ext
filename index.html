<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <title>Clarity-ext by Molmed</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>Clarity-ext</h1>
        <h2>Extensions for Clarity</h2>

        <section id="downloads">
          <a href="https://github.com/Molmed/clarity-ext/zipball/master" class="btn">Download as .zip</a>
          <a href="https://github.com/Molmed/clarity-ext/tarball/master" class="btn">Download as .tar.gz</a>
          <a href="https://github.com/Molmed/clarity-ext" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h1>
<a id="clarity-ext" class="anchor" href="#clarity-ext" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>clarity-ext</h1>

<p>NOTE: Work in progress (pre-alpha).</p>

<p>Provides a library for extending Clarity LIMS in a more developer-friendly way.</p>

<h2>
<a id="problem" class="anchor" href="#problem" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Problem</h2>

<p>Any LIMS system needs to be scripted (extended), as any lab has its own workflows. One extension could
be to create a driver file for a robot when the user presses a button in a workflow step.</p>

<p>The Clarity LIMS server provides extensibility in the form of so called EPPs. These are basically
shell commands that can be run on certain events in the system.</p>

<p>To develop and validate these steps, the developer would need to change the configuration entry for the
script in the LIMS and then run the script manually through the LIMS.</p>

<p>This method is cumbersome and doesn't provide an acceptable feedback loop for the developer.</p>

<h2>
<a id="solution" class="anchor" href="#solution" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Solution</h2>

<p>With <code>clarity-ext</code>, the developer can instead:</p>

<ul>
<li>Set a step up as usual</li>
<li>Write an extension that should run in this step</li>
<li>Run (integration test) the extension from his development environment</li>
<li>All requests/responses are cached, so the integration test will run fast. Furthermore, the test
can still be executed after the step has been deleted or altered. </li>
<li>Extensions have access to extension contexts, which do most of the work. This way, the readability 
and simplicity of the extensions increase, allowing non-developers to review and alter the code.</li>
</ul>

<h2>
<a id="components" class="anchor" href="#components" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Components</h2>

<h3>
<a id="runner" class="anchor" href="#runner" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Runner</h3>

<p>The first component of the system is the <code>clarity-ext</code> command line tool. All extensions are run through this tool.</p>

<p>For example, we have an extension that generates an input file for a Fragment Analyzer.
The <code>Process Type</code>s  EPP is set up like this in that case:</p>

<pre><code>clarity-ext extension --args 'pid={processLuid}' clarity_ext_scripts.fragment_analyzer.create_fa_input_file exec
</code></pre>

<p>However, when developing, developer runs this instead:</p>

<pre><code>clarity-ext extension clarity_ext_scripts.fragment_analyzer.create_fa_input_file test
</code></pre>

<p>These are the differences between the commands:</p>

<ul>
<li>The latter one uses a cache for requests/responses</li>
<li>The first one needs to provide the pid as an argument, while the second uses the test data defined in the extension</li>
</ul>

<p>The end result is that the user will get feedback directly in the IDE or terminal when running. It's faster because of
caching, but the tool will also output the file to stdout.</p>

<h3>
<a id="extensions" class="anchor" href="#extensions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Extensions</h3>

<p>The clarity_ext_scripts module includes extensions that have been implemented for the SNP&amp;SEQ technology platform at
Uppsala University. Some might be directly applied in another lab, but they are generally there as samples only.</p>

<p>The developer creates an extension by subclassing one of the extension base classes and implementing or overriding
one or more method.</p>

<p>Currently, there are two extension base classes:</p>

<ul>
<li>
<code>GeneralExtension</code>: The extensions's <code>execute</code> method will be run on execution</li>
<li>
<code>DriverFileExtension</code>: Provides methods that describe the file</li>
</ul>

<p>All extensions have access to the <code>ExtensionContext</code>. This object provides a higher level view on the data available
from the Clarity REST API. The extension can also import generic helper classes. All of the properties on this
object are generated lazily (on request), and an exception is thrown if they can't be used in the particular context
for some reason.</p>

<p>All extensions in the clarity_ext_scripts folder follow the design principle of leaving all non-trivial or boilerplate
code to the framework. The idea is that they can be understood by non-developers configuring or validating the system.
Furthermore, the idea is that all new extensions are made only with this framework.</p>

<h3>
<a id="helper-modules" class="anchor" href="#helper-modules" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Helper modules</h3>

<ul>
<li>clarity_ext.domain: Provides classes that help with work directly related to labs, such as a Plate object that
can enumerate wells in different ways.</li>
<li>clarity_ext.pdf: Provides ways to work with pdf files in a high level way, such as splitting them</li>
</ul>
      </section>
    </div>

    
  </body>
</html>
